<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <title>Food Tracker</title>
    <link th:href="@{/foodTracker.css}" rel="stylesheet"/>
</head>
<body>
<h1>Food Tracker</h1>

<!-- Logout Button -->
<form th:action="@{/logout}" method="post" style="display: inline;">
    <button type="submit" class="logout-btn">Log out</button>
</form>

<!-- Monthly Expenditure and Calorie Messages -->
<div>
    <p th:text="|Current Monthly Expenditure: ${totalExpenditure} Euros|"></p>
    <p th:text="|Current Daily Calorie Count: ${dailyCalories} kcal|"></p>
</div>


<!-- Interval Input Dialog -->
<!-- Interval Input Dialog -->
<dialog id="intervalDialog">
    <form th:action="@{/food/get-interval}" method="get">
        <h2>Enter Interval of Time</h2>
        <label for="interval-start">Start Date:</label>
        <input type="date" id="interval-start" name="start-date" required>
        <br><br>
        <label for="interval-end">End Date:</label>
        <input type="date" id="interval-end" name="end-date" required>
        <br><br>
        <menu>
            <button type="button" onclick="document.getElementById('intervalDialog').close()">Cancel</button>
            <button type="submit">Submit</button>
        </menu>
    </form>
</dialog>

<!-- Button to Open Interval Dialog -->
<button type="button" onclick="document.getElementById('intervalDialog').showModal()">Enter Interval of Time</button>



<!-- Food Entries Table -->
<table>
    <thead>
    <tr>
        <th>#</th>
        <th>Name</th>
        <th>Description</th>
        <th>Calories</th>
        <th>Price (&euro;)</th>
        <th>Date/Time</th>
        <th> </th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="foodEntry, iStat : ${foodEntries}">
        <td th:text="${iStat.index + 1}"></td>
        <td th:text="${foodEntry.name}"></td>
        <td th:text="${foodEntry.getDescription()}"></td>
        <td th:text="${foodEntry.calories}"></td>
        <td th:text="${foodEntry.price}"></td>
        <td>
          <span th:text="${foodEntry.getDate()}"></span>
          <br/>
          <span th:text="${foodEntry.getTime()}"></span>
        </td >
        <td>
          <input type="hidden" name="foodId" th:value="${foodEntry.getId()}" />
          <button type="button">Edit</button>
        </td>
    </tr>
    </tbody>
</table>

<!-- Button Container Box -->
<div class="button-container">
    <!-- Button for Add Food Entry -->
    <button id="addFoodBtn" type="button" onclick="document.getElementById('foodEntryDialog').showModal()">Add Food Entry</button>

    <!-- Button for Calorie Report -->
    <button type="button" onclick="document.getElementById('calorieReportDialog').showModal()">Calorie Report</button>

    <!-- Button for Go to User -->
    <a th:href="@{/user}" class="button-link">
        <button type="button" id="goToUser">Go to User</button>
    </a>
</div>

<!-- Food Entry Dialog -->
<dialog id="foodEntryDialog">
    <form th:action="@{/food/add}" method="post">
        <h2>Add or Edit Food Entry</h2>
        <label for="datetime">Date/Time</label>
        <input type="datetime-local" id="datetime" name="datetime" />
        <input type="checkbox" id="autoDatetime" onchange="document.getElementById('datetime').disabled = this.checked"> Use Current Time
        <br><br>

        <label for="foodName">Food Name</label>
        <input type="text" id="foodName" name="name" placeholder="e.g., Apple, Ice Cream" required />
        <br><br>

        <label for="description">Description</label>
        <input type="text" id="description" name="description" placeholder="e.g., Sweet, Sour" required />
        <br><br>

        <label for="calories">Calorie Value</label>
        <input type="number" id="calories" name="calories" placeholder="e.g., 120" required />
        <br><br>

        <label for="price">Price</label>
        <input type="number" step=".01" id="price" name="price" placeholder="e.g., 5.00" required />
        <br><br>

        <menu>
            <button value="cancel">Cancel</button>
            <button value="save">Save</button>
        </menu>
    </form>
</dialog>

<!-- Calorie Report Dialog -->
<dialog id="calorieReportDialog">
    <h2>Days Exceeding Calorie Limit</h2>
    <ul>
        <li th:each="day : ${exceededCalorieDays}" th:text="|Day: ${day.getKey()} with ${day.getValue()} calories|"></li>
    </ul>
    <button type="button" onclick="document.getElementById('calorieReportDialog').close()">Close</button>
</dialog>


</body>
</html>
